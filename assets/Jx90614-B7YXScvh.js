import{_ as I,J as O,a as R,b as j,e as G,c as M,f as X,g as E,h as K,i as L,s as P,d as q}from"./utils-CXPfh8Vn.js";import"./lodash-Dr83-R63.js";import{r as l,U as b,z as H,P as h,V as Q,A as W,C as m,D as e,O as Y,B as f,J as a,F as u,G as $,K as k,M as Z}from"./index-BK02bb7p.js";import{_ as ee}from"./Space-Dg0Pa17L.js";const te={style:{position:"relative",height:"60vh"}},ae={name:"DeviceJx90614"},ie=Object.assign(ae,{setup(ne){const o=l(!1),r=l(null),p=l(500),v=l(null),c=l("7F"),C=b("emitter");let d=null,n=null,g=Date.now();const{transmit:i,connect:D}=b("adapter"),y=async()=>{try{({temperature:r.value}=await d.measure());const t=Date.now();n.data.datasets[0].data.push({x:t,y:r.value}),t>g+50&&(g=t,h().then(()=>{n.options.scales.x.min=P(new Date,{minutes:1});const s=n.data.datasets[0].data.findLastIndex(_=>_.x<n.options.scales.x.min);n.data.datasets[0].data.splice(0,s),n.update()})),o.value&&(await q(p.value),y())}catch(t){console.log(t),o.value=!1}},T=async()=>{await D(),await i("AT"),await i("AT");const t=await i("AT+SC");if(!Array.from(t).includes(parseInt(c.value,16)))throw C.emit("message",{type:"error",data:{message:"Not Found"}}),new Error(`JX90614 at adrress 0x${c.value} NOT Found`);d=new O({transmit:i},c.value),await d.init(),o.value=!0,y()};return H(()=>{h().then(()=>{n=new Q(v.value,{type:"line",data:{datasets:[{label:"Temperature",fill:!1,data:[]}]},options:{spanGaps:!0,responsive:!0,maintainAspectRatio:!1,parsing:!1,normalized:!0,animations:{numbers:{properties:["x"],type:"number",from:void 0}},scales:{x:{type:"time",ticks:{stepSize:5},time:{unit:"second"},title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Celsius"}}}}})})}),W(()=>{n.destroy()}),(t,s)=>{const _=R,A=j,J=G,B=M,F=X,x=Z,N=ee,S=E,U=K,V=L,z=Y;return f(),m(z,null,{header:e(()=>[a(A,null,{default:e(()=>[a(_,null,{default:e(()=>[u("Device")]),_:1}),a(_,null,{default:e(()=>[u("JX90614")]),_:1})]),_:1})]),"header-extra":e(()=>[a(N,null,{default:e(()=>[a(F,{"label-placement":"left",inline:""},{default:e(()=>[a(B,{label:`${t.$t("adapter.Interval")} (ms)`,style:{width:"300px"}},{default:e(()=>[a(J,{value:p.value,"onUpdate:value":s[0]||(s[0]=w=>p.value=w),step:100,min:0,max:1e3},null,8,["value"])]),_:1},8,["label"])]),_:1}),a(I),o.value?(f(),m(x,{key:0,onClick:s[1]||(s[1]=w=>{o.value=!1}),type:"warning"},{default:e(()=>[u($(t.$t("adapter.Stop")),1)]),_:1})):(f(),m(x,{key:1,onClick:T,type:"primary"},{default:e(()=>[u($(t.$t("adapter.Start")),1)]),_:1}))]),_:1})]),default:e(()=>[a(V,{"x-gap":"12",cols:1},{default:e(()=>[a(U,null,{default:e(()=>[a(S,{label:t.$t("measurement.Temperature"),value:r.value},{suffix:e(()=>[u("Celsius")]),_:1},8,["label","value"])]),_:1})]),_:1}),k("div",te,[k("canvas",{ref_key:"chartRef",ref:v},null,512)])]),_:1})}}});export{ie as default};
