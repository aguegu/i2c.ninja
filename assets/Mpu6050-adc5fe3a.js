import{f as F,s as g,_ as K,M as q,a as H,b as Q,c as W,d as ee,e as ae,g as te,h as le,i as se,j as ne}from"./utils-4a2a637f.js";import"./lodash-cd78795a.js";import{r,T as N,z as oe,P as X,U as Y,A as ue,B as d,C as D,D as a,O as re,J as e,F as c,V as $,X as z,Y as S,K as x,M as ce,G as U}from"./index-b4fcf539.js";import{_ as ie,a as pe}from"./RadioGroup-8503da45.js";import{_ as de}from"./Space-22a2d323.js";const _e={style:{position:"relative",height:"30vh"}},me={style:{position:"relative",height:"30vh"}},ve={name:"DeviceMpu6050"},we=Object.assign(ve,{setup(fe){const _=r(!1),b=r(100),m=r("68"),h=r("500"),w=r("4"),n=r({accelerometers:{},gyroscopes:{}}),I=N("emitter"),R=r(null);let o=null;const C=r(null);let u=null;const{transmit:v,connect:O}=N("adapter");let A=null,M=Date.now();const T=async()=>{try{n.value=await A.measure();const s=Date.now();o.data.datasets[0].data.push({x:s,y:n.value.accelerometers.x}),o.data.datasets[1].data.push({x:s,y:n.value.accelerometers.y}),o.data.datasets[2].data.push({x:s,y:n.value.accelerometers.z}),u.data.datasets[0].data.push({x:s,y:n.value.gyroscopes.x}),u.data.datasets[1].data.push({x:s,y:n.value.gyroscopes.y}),u.data.datasets[2].data.push({x:s,y:n.value.gyroscopes.z}),s>M+50&&(M=s,X().then(()=>{o.options.scales.x.min=g(s,{minutes:1}),u.options.scales.x.min=g(s,{minutes:1});const l=o.data.datasets[0].data.findLastIndex(f=>f.x<o.options.scales.x.min);o.data.datasets[0].data.splice(0,l),o.data.datasets[1].data.splice(0,l),o.data.datasets[2].data.splice(0,l),u.data.datasets[0].data.splice(0,l),u.data.datasets[1].data.splice(0,l),u.data.datasets[2].data.splice(0,l),o.update(),u.update()})),_.value&&(await ne(b.value),T())}catch(s){console.log(s),_.value=!1}},V=async()=>{await O(),await v("AT"),await v("AT");const s=await v("AT+SC");if(!Array.from(s).includes(parseInt(m.value,16)))throw I.emit("message",{type:"error",data:{message:"Not Found"}}),new Error(`MPU6050 at adrress 0x${m.value} NOT Found`);A=new q({transmit:v},m.value),await A.init(h.value,w.value),_.value=!0,T()};return oe(()=>{X().then(()=>{o=new Y(R.value,{type:"line",data:{datasets:[{label:"Accelerometers.X",fill:!1,data:[]},{label:"Accelerometers.Y",fill:!1,data:[]},{label:"Accelerometers.Z",fill:!1,data:[]}]},options:{spanGaps:!0,responsive:!0,maintainAspectRatio:!1,parsing:!1,normalized:!0,animations:{numbers:{properties:["x"],type:"number",from:void 0}},scales:{x:{type:"time",min:F(g(new Date,{minutes:1})),ticks:{stepSize:5},time:{unit:"second"},title:{display:!0,text:"Date"}},y:{title:{display:!0,text:""}}}}}),u=new Y(C.value,{type:"line",data:{datasets:[{label:"Gyroscopes.X",fill:!1,data:[]},{label:"Gyroscopes.Y",fill:!1,data:[]},{label:"Gyroscopes.Z",fill:!1,data:[]}]},options:{spanGaps:!0,responsive:!0,maintainAspectRatio:!1,parsing:!1,normalized:!0,animations:{numbers:{properties:["x"],type:"number",from:void 0}},scales:{x:{type:"time",min:F(g(new Date,{minutes:1})),ticks:{stepSize:5},time:{unit:"second"},title:{display:!0,text:"Date"}},y:{title:{display:!0,text:""}}}}})})}),ue(()=>{o.destroy(),u.destroy()}),(s,l)=>{const f=H,Z=Q,k=pe,G=ie,y=W,j=ee,P=ae,B=ce,E=de,i=te,p=le,L=se,J=re;return d(),D(J,null,{header:a(()=>[e(Z,null,{default:a(()=>[e(f,null,{default:a(()=>[c("Device")]),_:1}),e(f,null,{default:a(()=>[c("MPU6050")]),_:1})]),_:1})]),"header-extra":a(()=>[e(E,null,{default:a(()=>[e(P,{"label-placement":"left",inline:""},{default:a(()=>[e(y,{label:"Address:"},{default:a(()=>[e(G,{value:m.value,"onUpdate:value":l[0]||(l[0]=t=>m.value=t)},{default:a(()=>[(d(),$(S,null,z(["68","69"],t=>e(k,{key:t,value:t},{default:a(()=>[c("0x"+U(t),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1}),e(y,{label:"Gyroscopes Range:"},{default:a(()=>[e(G,{value:h.value,"onUpdate:value":l[1]||(l[1]=t=>h.value=t)},{default:a(()=>[(d(),$(S,null,z(["250","500","1000","2000"],t=>e(k,{key:t,value:t},{default:a(()=>[c(U(`±${t}°/s`),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1}),e(y,{label:"Accelerometers Range:"},{default:a(()=>[e(G,{value:w.value,"onUpdate:value":l[2]||(l[2]=t=>w.value=t)},{default:a(()=>[(d(),$(S,null,z(["2","4","8","16"],t=>e(k,{key:t,value:t},{default:a(()=>[c(U(`±${t}g`),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1}),e(y,{label:"Interval (ms):",style:{width:"300px"}},{default:a(()=>[e(j,{value:b.value,"onUpdate:value":l[3]||(l[3]=t=>b.value=t),step:100,min:0,max:1e3},null,8,["value"])]),_:1})]),_:1}),e(K),_.value?(d(),D(B,{key:0,onClick:l[4]||(l[4]=t=>{_.value=!1}),type:"warning"},{default:a(()=>[c("Stop")]),_:1})):(d(),D(B,{key:1,onClick:V,type:"primary"},{default:a(()=>[c("Start")]),_:1}))]),_:1})]),default:a(()=>[e(L,{"x-gap":"12",cols:6},{default:a(()=>[e(p,null,{default:a(()=>[e(i,{label:"Accelerometers.X",value:n.value.accelerometers.x},null,8,["value"])]),_:1}),e(p,null,{default:a(()=>[e(i,{label:"Accelerometers.Y",value:n.value.accelerometers.y},null,8,["value"])]),_:1}),e(p,null,{default:a(()=>[e(i,{label:"Accelerometers.Z",value:n.value.accelerometers.z},null,8,["value"])]),_:1}),e(p,null,{default:a(()=>[e(i,{label:"Gyroscopes.X",value:n.value.gyroscopes.x},null,8,["value"])]),_:1}),e(p,null,{default:a(()=>[e(i,{label:"Gyroscopes.Y",value:n.value.gyroscopes.y},null,8,["value"])]),_:1}),e(p,null,{default:a(()=>[e(i,{label:"Gyroscopes.Z",value:n.value.gyroscopes.z},null,8,["value"])]),_:1})]),_:1}),x("div",_e,[x("canvas",{ref_key:"chartAccelerometersRef",ref:R},null,512)]),x("div",me,[x("canvas",{ref_key:"chartGyroscopesRef",ref:C},null,512)])]),_:1})}}});export{we as default};
